---
level: Imperial
---
---
level: Imperial
---
---
level: Imperial
---
---
level: Imperial
---
---
encrypt_content:
  level: Imperial
  password: Raymond#1234
  username: hg1523
level: Imperial
---
# 1:
## (i):
```java
    @Test

  public void test1() {

  

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_ACCEPTED);

      exactly(1).of(paymentSystem).charge(10, Name.ALICE);

    }});

    manager.startAuction(Items.A, Name.SOMEONE);

    Status outcome = manager.bid(10, Name.ALICE);

    assertEquals(outcome, Status.BID_ACCEPTED);

  }
```

```java
package ic.doc;

  

public class AuctionManager {

  private Seller seller;

  private Bidder bidder;

  private PaymentSystem paymentSystem;

  private Dispatcher dispatcher;

  

  public AuctionManager(

    Seller seller,

    Bidder bidder,

    PaymentSystem paymentSystem,

    Dispatcher dispatcher

  ){

    this.seller = seller;

    this.bidder = bidder;

    this.paymentSystem = paymentSystem;

    this.dispatcher = dispatcher;

  }

  

  public void startAuction(Items items, Name name){}

  public void endAuction(){}

  public Status bid(int num, Name name){

    bidder.notifyStatus(Status.BID_ACCEPTED);

    paymentSystem.charge(num, name);

    return Status.BID_ACCEPTED;

  }

}
```

## 2:
```java
  @Test

  public void test2() {

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_TOO_LOW);

    }});

    Status outcome = manager.bid(5,Name.CAROLE);

    assertEquals(outcome, Status.BID_TOO_LOW);

  }
```

```java
package ic.doc;

  

public class AuctionManager {

  private Seller seller;

  private Bidder bidder;

  private PaymentSystem paymentSystem;

  private Dispatcher dispatcher;

  

  public AuctionManager(

    Seller seller,

    Bidder bidder,

    PaymentSystem paymentSystem,

    Dispatcher dispatcher

  ){

    this.seller = seller;

    this.bidder = bidder;

    this.paymentSystem = paymentSystem;

    this.dispatcher = dispatcher;

  }

  

  public void startAuction(Items items, Name name){}

  public void endAuction(){}

  public Status bid(int num, Name name){

    Status status = Status.BID_TOO_LOW;

    if (num == 10 && name == Name.ALICE) {

      status = Status.BID_ACCEPTED;

      bidder.notifyStatus(status);

      paymentSystem.charge(num, name);

    } else if (num == 5 && name == Name.CAROLE) {

      // status = Status.BID_TOO_LOW;

      bidder.notifyStatus(status);

    }

    return status;

  }

}
```

## (iii)
```java
  @Test

  public void test3() {

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_ACCEPTED);

      exactly(1).of(paymentSystem).charge(20, Name.DAVID);

    }});

    Status outcome = manager.bid(20, Name.DAVID);

    assertEquals(outcome, Status.BID_ACCEPTED);

  }
```

```java
package ic.doc;

  

public class AuctionManager {

  private Seller seller;

  private Bidder bidder;

  private PaymentSystem paymentSystem;

  private Dispatcher dispatcher;

  

  public AuctionManager(

    Seller seller,

    Bidder bidder,

    PaymentSystem paymentSystem,

    Dispatcher dispatcher

  ){

    this.seller = seller;

    this.bidder = bidder;

    this.paymentSystem = paymentSystem;

    this.dispatcher = dispatcher;

  }

  

  public void startAuction(Items items, Name name){}

  public void endAuction(){}

  public Status bid(int num, Name name){

    Status status = Status.BID_TOO_LOW;

    if (num == 10 && name == Name.ALICE) {

      status = Status.BID_ACCEPTED;

      bidder.notifyStatus(status);

      paymentSystem.charge(num, name);

    } else if (num == 5 && name == Name.CAROLE) {

      // status = Status.BID_TOO_LOW;

      bidder.notifyStatus(status);

    } else if (num == 20 && name == Name.DAVID) {

      status = Status.BID_ACCEPTED;

      bidder.notifyStatus(status);

      paymentSystem.charge(num, name);

    }

    return status;

  }

}
```
## (iv)
```java
package ic.doc;

  

import org.junit.Rule;

import org.junit.Test;

  

import static org.junit.Assert.assertEquals;

import static org.junit.Assert.assertThat;

  

import org.jmock.Expectations;

import org.jmock.Mockery;

import org.jmock.integration.junit4.JMock;

import org.jmock.integration.junit4.JUnitRuleMockery;

  

public class AuctionManagerTest {

  @Rule

  public JUnitRuleMockery context = new JUnitRuleMockery();

  private final Seller seller = context.mock(Seller.class);

  private final Bidder bidder = context.mock(Bidder.class);

  private final PaymentSystem paymentSystem = context.mock(PaymentSystem.class);

  private final Dispatcher dispatcher = context.mock(Dispatcher.class);

  private final AuctionManager manager = new AuctionManager(

    seller,

    bidder,

    paymentSystem,

    dispatcher

  );

  

  @Test

  public void test1() {

  

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_ACCEPTED);

      exactly(1).of(paymentSystem).charge(10, Name.ALICE);

    }});

    manager.startAuction(Items.A, Name.SELLER);

    Status outcome = manager.bid(10, Name.ALICE);

    assertEquals(outcome, Status.BID_ACCEPTED);

  }

  

  @Test

  public void test2() {

    test1();

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_TOO_LOW);

    }});

    Status outcome = manager.bid(5,Name.CAROLE);

    assertEquals(outcome, Status.BID_TOO_LOW);

  }

  

  @Test

  public void test3() {

    test2();

    context.checking(new Expectations(){{

      exactly(1).of(bidder).notifyStatus(Status.BID_ACCEPTED);

      exactly(1).of(paymentSystem).charge(20, Name.DAVID);

    }});

    Status outcome = manager.bid(20, Name.DAVID);

    assertEquals(outcome, Status.BID_ACCEPTED);

  }

  

  @Test

  public void test4() {

    test3();

    context.checking(new Expectations(){{

      exactly(1).of(paymentSystem).pay(20, Name.SELLER);

      exactly(1).of(paymentSystem).pay(10, Name.ALICE);

      exactly(1).of(dispatcher).dispatch(Items.A, Name.DAVID);

    }});

    manager.endAuction();

  }

  

}
```

# 2
## a:
we use the singleton pattern

```java
    private static MediaLibrary instance = new MediaLibrary();

    public static MediaLibrary getInstnace() {

        return instance;

    }

    private final List<Movie> topMovies;

  

    private MediaLibrary() {
```